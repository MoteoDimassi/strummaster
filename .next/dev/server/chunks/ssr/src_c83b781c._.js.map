{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/store/hooks.ts"],"sourcesContent":["import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\nimport type { RootState, AppDispatch } from './index';\n\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;"],"names":[],"mappings":";;;;;;AAAA;;AAGO,MAAM,iBAAiB,IAAM,IAAA,wKAAW;AACxC,MAAM,iBAAkD,wKAAW"}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/shared/components/Header.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport { Music, Volume2, ChevronDown, Menu, X } from 'lucide-react';\nimport { useAppDispatch } from '../../store/hooks';\nimport { openTuner } from '../../store/slices/tunerSlice';\n\ninterface HeaderProps {\n  onToolSelect?: (tool: string) => void;\n}\n\nexport const Header: React.FC<HeaderProps> = ({ onToolSelect }) => {\n  const [isToolsDropdownOpen, setIsToolsDropdownOpen] = useState(false);\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\n  const dispatch = useAppDispatch();\n\n  const handleNavClick = (item: string) => {\n    console.log(`Нажато на: ${item}`);\n    if (onToolSelect) onToolSelect(item); // Reset tool selection if navigating away\n    setIsMobileMenuOpen(false);\n  };\n\n  const handleToolsClick = (tool: string) => {\n    console.log(`Выбран инструмент: ${tool}`);\n    if (onToolSelect) onToolSelect(tool);\n    setIsToolsDropdownOpen(false);\n    setIsMobileMenuOpen(false);\n  };\n\n  const handleOpenTuner = () => {\n    dispatch(openTuner());\n  };\n\n  return (\n    <header className=\"bg-slate-950/50 backdrop-blur-md border-b border-white/10 p-4 sticky top-0 z-50\">\n      <div className=\"max-w-6xl mx-auto flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"bg-gradient-to-br from-amber-400 to-orange-600 p-2 rounded-lg shadow-lg shadow-orange-500/20\">\n            <Music className=\"text-white\" size={24} />\n          </div>\n          <div>\n            <h1 className=\"text-xl font-bold bg-gradient-to-r from-white to-slate-400 bg-clip-text text-transparent\">\n              StrumMaster\n            </h1>\n            <p className=\"text-xs text-slate-500 font-medium\">Guitar Rhythm Trainer</p>\n          </div>\n        </div>\n        \n        {/* Desktop Navigation */}\n        <nav className=\"hidden md:flex items-center gap-6\">\n          <Link\n            href=\"/\"\n            className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium\"\n          >\n            Главная\n          </Link>\n          <button\n            onClick={() => handleNavClick('Курсы')}\n            className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium\"\n          >\n            Курсы\n          </button>\n          <div className=\"relative\">\n            <button\n              onClick={() => setIsToolsDropdownOpen(!isToolsDropdownOpen)}\n              className=\"flex items-center gap-1 text-slate-300 hover:text-white transition-colors text-sm font-medium\"\n            >\n              Инструменты\n              <ChevronDown size={16} className={`transition-transform ${isToolsDropdownOpen ? 'rotate-180' : ''}`} />\n            </button>\n            {isToolsDropdownOpen && (\n              <div className=\"absolute top-full left-0 mt-2 bg-slate-900 border border-white/10 rounded-lg shadow-xl min-w-48 py-2\">\n                <Link\n                  href=\"/tuner\"\n                  className=\"block w-full text-left px-4 py-2 text-sm text-slate-300 hover:bg-slate-800 hover:text-white transition-colors\"\n                >\n                  Тюнер\n                </Link>\n                <button\n                  onClick={() => handleToolsClick('Метроном')}\n                  className=\"block w-full text-left px-4 py-2 text-sm text-slate-300 hover:bg-slate-800 hover:text-white transition-colors\"\n                >\n                  Метроном\n                </button>\n                <button\n                  onClick={() => handleToolsClick('Анализатор аккордов')}\n                  className=\"block w-full text-left px-4 py-2 text-sm text-slate-300 hover:bg-slate-800 hover:text-white transition-colors\"\n                >\n                  Анализатор аккордов\n                </button>\n                <button\n                  onClick={() => handleToolsClick('Генератор аккордов')}\n                  className=\"block w-full text-left px-4 py-2 text-sm text-slate-300 hover:bg-slate-800 hover:text-white transition-colors\"\n                >\n                  Генератор аккордов\n                </button>\n                <Link\n                  href=\"/dictation\"\n                  className=\"block w-full text-left px-4 py-2 text-sm text-slate-300 hover:bg-slate-800 hover:text-white transition-colors\"\n                >\n                  Музыкальный диктант\n                </Link>\n              </div>\n            )}\n          </div>\n          <button\n            onClick={() => handleNavClick('Блог')}\n            className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium\"\n          >\n            Блог\n          </button>\n          <button\n            onClick={() => handleNavClick('Табы')}\n            className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium\"\n          >\n            Табы\n          </button>\n          <Link\n            href=\"/tuner\"\n            className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors ml-4\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n              <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"></line>\n              <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"></line>\n            </svg>\n            Тюнер\n          </Link>\n        </nav>\n\n        {/* Mobile menu button */}\n        <button\n          onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\n          className=\"md:hidden text-slate-300 hover:text-white\"\n        >\n          {isMobileMenuOpen ? <X size={24} /> : <Menu size={24} />}\n        </button>\n      </div>\n\n      {/* Mobile Navigation */}\n      {isMobileMenuOpen && (\n        <div className=\"md:hidden mt-4 pt-4 border-t border-white/10\">\n          <nav className=\"flex flex-col gap-4\">\n            <Link\n              href=\"/\"\n              className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium text-left\"\n            >\n              Главная\n            </Link>\n            <button\n              onClick={() => handleNavClick('Курсы')}\n              className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium text-left\"\n            >\n              Курсы\n            </button>\n            <div>\n              <button\n                onClick={() => setIsToolsDropdownOpen(!isToolsDropdownOpen)}\n                className=\"flex items-center gap-1 text-slate-300 hover:text-white transition-colors text-sm font-medium w-full text-left\"\n              >\n                Инструменты\n                <ChevronDown size={16} className={`transition-transform ${isToolsDropdownOpen ? 'rotate-180' : ''}`} />\n              </button>\n              {isToolsDropdownOpen && (\n                <div className=\"mt-2 ml-4 space-y-2\">\n                  <Link\n                    href=\"/tuner\"\n                    className=\"block w-full text-left text-sm text-slate-400 hover:text-white transition-colors\"\n                  >\n                    Тюнер\n                  </Link>\n                  <button\n                    onClick={() => handleToolsClick('Метроном')}\n                    className=\"block w-full text-left text-sm text-slate-400 hover:text-white transition-colors\"\n                  >\n                    Метроном\n                  </button>\n                  <button\n                    onClick={() => handleToolsClick('Анализатор аккордов')}\n                    className=\"block w-full text-left text-sm text-slate-400 hover:text-white transition-colors\"\n                  >\n                    Анализатор аккордов\n                  </button>\n                  <button\n                    onClick={() => handleToolsClick('Генератор аккордов')}\n                    className=\"block w-full text-left text-sm text-slate-400 hover:text-white transition-colors\"\n                  >\n                    Генератор аккордов\n                  </button>\n                  <Link\n                    href=\"/dictation\"\n                    className=\"block w-full text-left text-sm text-slate-400 hover:text-white transition-colors\"\n                  >\n                    Музыкальный диктант\n                  </Link>\n                </div>\n              )}\n            </div>\n            <button\n              onClick={() => handleNavClick('Блог')}\n              className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium text-left\"\n            >\n              Блог\n            </button>\n            <button\n              onClick={() => handleNavClick('Табы')}\n              className=\"text-slate-300 hover:text-white transition-colors text-sm font-medium text-left\"\n            >\n              Табы\n            </button>\n            <Link\n              href=\"/tuner\"\n              className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors\"\n            >\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n                <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"></line>\n                <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"></line>\n              </svg>\n              Тюнер\n            </Link>\n          </nav>\n        </div>\n      )}\n    </header>\n  );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 522, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/shared/components/Footer.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { Send, Type, Instagram, Youtube, Music } from 'lucide-react';\n\nexport const Footer: React.FC = () => {\n  const currentYear = new Date().getFullYear();\n  const appVersion = '0.0.0'; // Версия из package.json\n\n  const handleSocialClick = (social: string) => {\n    console.log(`Переход на социальную сеть: ${social}`);\n  };\n\n  const handleLinkClick = (link: string) => {\n    console.log(`Переход на страницу: ${link}`);\n  };\n\n  return (\n    <footer className=\"bg-slate-950/50 backdrop-blur-md border-t border-white/10 p-6 mt-auto\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Основной контент футера */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 mb-8\">\n          {/* Информация о приложении */}\n          <div className=\"flex flex-col items-center md:items-start\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"bg-gradient-to-br from-amber-400 to-orange-600 p-2 rounded-lg shadow-lg shadow-orange-500/20\">\n                <Music className=\"text-white\" size={20} />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-bold bg-gradient-to-r from-white to-slate-400 bg-clip-text text-transparent\">\n                  StrumMaster\n                </h3>\n                <p className=\"text-xs text-slate-500 font-medium\">Guitar Rhythm Trainer</p>\n              </div>\n            </div>\n            <p className=\"text-sm text-slate-400 text-center md:text-left\">\n              Ваш помощник в изучении игры на гитаре. Тренируйте ритм, настраивайте инструмент и улучшайте навыки.\n            </p>\n          </div>\n\n          {/* Полезные ссылки */}\n          <div className=\"flex flex-col items-center md:items-center\">\n            <h4 className=\"text-sm font-semibold text-white mb-4\">Полезные ссылки</h4>\n            <div className=\"flex flex-col gap-2\">\n              <button\n                onClick={() => handleLinkClick('Политика конфиденциальности')}\n                className=\"text-sm text-slate-400 hover:text-white transition-colors\"\n              >\n                Политика конфиденциальности\n              </button>\n              <button\n                onClick={() => handleLinkClick('Договор оферты')}\n                className=\"text-sm text-slate-400 hover:text-white transition-colors\"\n              >\n                Договор оферты\n              </button>\n            </div>\n          </div>\n\n          {/* Социальные сети */}\n          <div className=\"flex flex-col items-center md:items-end\">\n            <h4 className=\"text-sm font-semibold text-white mb-4\">Мы в социальных сетях</h4>\n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => handleSocialClick('Telegram')}\n                className=\"bg-slate-800 hover:bg-slate-700 p-2 rounded-lg transition-colors group\"\n                aria-label=\"Telegram\"\n              >\n                <Send className=\"text-slate-400 group-hover:text-white transition-colors\" size={18} />\n              </button>\n              <button\n                onClick={() => handleSocialClick('TikTok')}\n                className=\"bg-slate-800 hover:bg-slate-700 p-2 rounded-lg transition-colors group\"\n                aria-label=\"TikTok\"\n              >\n                <Type className=\"text-slate-400 group-hover:text-white transition-colors\" size={18} />\n              </button>\n              <button\n                onClick={() => handleSocialClick('Instagram')}\n                className=\"bg-slate-800 hover:bg-slate-700 p-2 rounded-lg transition-colors group\"\n                aria-label=\"Instagram\"\n              >\n                <Instagram className=\"text-slate-400 group-hover:text-white transition-colors\" size={18} />\n              </button>\n              <button\n                onClick={() => handleSocialClick('YouTube')}\n                className=\"bg-slate-800 hover:bg-slate-700 p-2 rounded-lg transition-colors group\"\n                aria-label=\"YouTube\"\n              >\n                <Youtube className=\"text-slate-400 group-hover:text-white transition-colors\" size={18} />\n              </button>\n            </div>\n          </div>\n        </div>\n\n        {/* Разделитель */}\n        <div className=\"border-t border-white/10 mb-6\"></div>\n\n        {/* Копирайт и версия */}\n        <div className=\"flex flex-col md:flex-row justify-between items-center gap-4\">\n          <div className=\"text-sm text-slate-500 text-center md:text-left\">\n            © {currentYear} StrumMaster. Все права защищены.\n          </div>\n          <div className=\"flex items-center gap-4\">\n            <div className=\"text-xs text-slate-600 font-mono\">\n              Версия: {appVersion}\n            </div>\n            <div className=\"flex items-center gap-2 text-xs font-mono text-slate-500 border border-slate-800 px-3 py-1 rounded-full\">\n              <Music size={10} />\n              <span>Synth Active</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n};"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAAA;AAAA;AAHA;;;AAKO,MAAM,SAAmB;IAC9B,MAAM,cAAc,IAAI,OAAO,WAAW;IAC1C,MAAM,aAAa,SAAS,yBAAyB;IAErD,MAAM,oBAAoB,CAAC;QACzB,QAAQ,GAAG,CAAC,CAAC,4BAA4B,EAAE,QAAQ;IACrD;IAEA,MAAM,kBAAkB,CAAC;QACvB,QAAQ,GAAG,CAAC,CAAC,qBAAqB,EAAE,MAAM;IAC5C;IAEA,qBACE,8OAAC;QAAO,WAAU;kBAChB,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;sDACb,cAAA,8OAAC,6MAAK;gDAAC,WAAU;gDAAa,MAAM;;;;;;;;;;;sDAEtC,8OAAC;;8DACC,8OAAC;oDAAG,WAAU;8DAA2F;;;;;;8DAGzG,8OAAC;oDAAE,WAAU;8DAAqC;;;;;;;;;;;;;;;;;;8CAGtD,8OAAC;oCAAE,WAAU;8CAAkD;;;;;;;;;;;;sCAMjE,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;8CAAwC;;;;;;8CACtD,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,SAAS,IAAM,gBAAgB;4CAC/B,WAAU;sDACX;;;;;;sDAGD,8OAAC;4CACC,SAAS,IAAM,gBAAgB;4CAC/B,WAAU;sDACX;;;;;;;;;;;;;;;;;;sCAOL,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;8CAAwC;;;;;;8CACtD,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,SAAS,IAAM,kBAAkB;4CACjC,WAAU;4CACV,cAAW;sDAEX,cAAA,8OAAC,0MAAI;gDAAC,WAAU;gDAA0D,MAAM;;;;;;;;;;;sDAElF,8OAAC;4CACC,SAAS,IAAM,kBAAkB;4CACjC,WAAU;4CACV,cAAW;sDAEX,cAAA,8OAAC,0MAAI;gDAAC,WAAU;gDAA0D,MAAM;;;;;;;;;;;sDAElF,8OAAC;4CACC,SAAS,IAAM,kBAAkB;4CACjC,WAAU;4CACV,cAAW;sDAEX,cAAA,8OAAC,yNAAS;gDAAC,WAAU;gDAA0D,MAAM;;;;;;;;;;;sDAEvF,8OAAC;4CACC,SAAS,IAAM,kBAAkB;4CACjC,WAAU;4CACV,cAAW;sDAEX,cAAA,8OAAC,mNAAO;gDAAC,WAAU;gDAA0D,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8BAO3F,8OAAC;oBAAI,WAAU;;;;;;8BAGf,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;gCAAkD;gCAC5D;gCAAY;;;;;;;sCAEjB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;wCAAmC;wCACvC;;;;;;;8CAEX,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,6MAAK;4CAAC,MAAM;;;;;;sDACb,8OAAC;sDAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOpB"}},
    {"offset": {"line": 848, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/core/dictation/musicTheory.ts"],"sourcesContent":["import { Note, NoteName, ScaleType } from './types';\n\nexport const NOTE_NAMES_SHARP: NoteName[] = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\nexport const NOTE_NAMES_FLAT: NoteName[] =  ['C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'];\n\nexport const OCTAVE_LABELS: Record<number, string> = {\n  2: 'Great',\n  3: 'Small',\n  4: '1st',\n  5: '2nd'\n};\n\nexport const SCALE_INTERVALS: Record<ScaleType, number[]> = {\n  'Major': [0, 2, 4, 5, 7, 9, 11],\n  'Minor': [0, 2, 3, 5, 7, 8, 10] // Natural minor\n};\n\nexport const getNoteFromMidi = (midi: number, useFlats: boolean = false): Note => {\n  const nameIndex = midi % 12;\n  const octave = Math.floor(midi / 12) - 1;\n  const name = useFlats ? NOTE_NAMES_FLAT[nameIndex] : NOTE_NAMES_SHARP[nameIndex];\n  \n  // Calculate frequency: f = 440 * 2^((d-69)/12)\n  const frequency = 440 * Math.pow(2, (midi - 69) / 12);\n  \n  return { name, octave, frequency, midi };\n};\n\nconst getRootIndex = (root: NoteName): number => {\n  let idx = NOTE_NAMES_SHARP.indexOf(root);\n  if (idx === -1) idx = NOTE_NAMES_FLAT.indexOf(root);\n  return idx;\n};\n\nexport const generateScale = (root: NoteName, type: ScaleType, selectedOctaves: number[], rangeLimit: number = 7): Note[] => {\n  const flatKeysMajor = ['F', 'Bb', 'Eb', 'Ab', 'Db', 'Gb'];\n  const flatKeysMinor = ['D', 'G', 'C', 'F', 'Bb', 'Eb'];\n  \n  const useFlats = (type === 'Major' && flatKeysMajor.includes(root)) ||\n                   (type === 'Minor' && flatKeysMinor.includes(root));\n\n  const rootIndex = getRootIndex(root);\n  const intervals = SCALE_INTERVALS[type];\n  const notes: Note[] = [];\n\n  // Sort octaves to ensure correct order\n  const sortedOctaves = [...selectedOctaves].sort((a, b) => a - b);\n\n  sortedOctaves.forEach(octave => {\n    // Standard MIDI octave numbering: C4 is 60. \n    const octaveBaseMidi = (octave + 1) * 12; \n    const rootMidi = octaveBaseMidi + rootIndex;\n\n    intervals.forEach(interval => {\n        notes.push(getNoteFromMidi(rootMidi + interval, useFlats));\n    });\n  });\n\n  const sortedNotes = notes.sort((a, b) => a.midi - b.midi);\n\n  // Filter by rangeLimit (number of notes from the scale starting from tonic)\n  // 1. Identify distinct pitch classes starting from the root of the lowest octave.\n  // Since sortedNotes is sorted by MIDI, and the lowest note generated is the root of the lowest octave,\n  // the order of pitch classes encountered will start with the Tonic.\n  const uniquePitchClasses = Array.from(new Set(sortedNotes.map(n => n.midi % 12)));\n  const allowedPitchClasses = uniquePitchClasses.slice(0, rangeLimit);\n  \n  return sortedNotes.filter(n => allowedPitchClasses.includes(n.midi % 12));\n};\n\nexport const generateMelody = (scale: Note[], length: number, difficulty: number): Note[] => {\n  if (scale.length === 0) return [];\n  \n  // The scale is already filtered by generateScale to contain only the allowed notes.\n  const pool = scale;\n\n  // 2. Define Max Interval based on Difficulty\n  // Level 1: 2 semitones\n  // Level 2: 4 semitones\n  // Level 3: 7 semitones\n  // Level 4: 9 semitones\n  // Level 5: 12 semitones\n  const maxIntervalMap: Record<number, number> = {\n      1: 2,\n      2: 4,\n      3: 7,\n      4: 9,\n      5: 12\n  };\n  const maxInterval = maxIntervalMap[difficulty] || 12;\n\n  const melody: Note[] = [];\n  \n  // First note is random from the pool\n  melody.push(pool[Math.floor(Math.random() * pool.length)]);\n  \n  // Subsequent notes\n  for (let i = 1; i < length; i++) {\n      const prevNote = melody[i - 1];\n      \n      // Filter candidates that are within the allowed interval distance\n      const candidates = pool.filter(n => {\n          const interval = Math.abs(n.midi - prevNote.midi);\n          return interval <= maxInterval; \n      });\n\n      if (candidates.length > 0) {\n          const nextNote = candidates[Math.floor(Math.random() * candidates.length)];\n          melody.push(nextNote);\n      } else {\n          // Fallback if no notes within range\n          melody.push(pool[Math.floor(Math.random() * pool.length)]);\n      }\n  }\n\n  return melody;\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1021, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/features/dictation/screens/SetupScreen.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { GameSettings, NoteName, ScaleType } from '../../../core/dictation/types';\nimport { Play, Music, Star, ChevronDown, ChevronUp, Settings2 } from 'lucide-react';\nimport { OCTAVE_LABELS } from '../../../core/dictation/musicTheory';\n\ninterface SetupScreenProps {\n  onStart: (settings: GameSettings) => void;\n}\n\nconst PRESETS: Record<number, Partial<GameSettings>> = {\n  1: { replayLimit: 'infinity', scaleRange: 3, melodyNoteCount: 3, selectedOctaves: [4] },\n  2: { replayLimit: 'infinity', scaleRange: 4, melodyNoteCount: 5, selectedOctaves: [4] },\n  3: { replayLimit: 7, scaleRange: 5, melodyNoteCount: 5, selectedOctaves: [4] },\n  4: { replayLimit: 5, scaleRange: 6, melodyNoteCount: 6, selectedOctaves: [3, 4] },\n  5: { replayLimit: 3, scaleRange: 7, melodyNoteCount: 7, selectedOctaves: [3, 4] },\n};\n\nexport const SetupScreen: React.FC<SetupScreenProps> = ({ onStart }) => {\n  const [showAdvanced, setShowAdvanced] = useState(false);\n  \n  // Default to level 3 settings\n  const [settings, setSettings] = useState<GameSettings>({\n    rootNote: 'C',\n    scaleType: 'Major',\n    difficulty: 3,\n    ...PRESETS[3] as any\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (settings.selectedOctaves.length === 0) {\n        alert(\"Please select at least one octave.\");\n        return;\n    }\n    onStart(settings);\n  };\n\n  const handleDifficultyChange = (level: number) => {\n    setSettings(prev => ({\n        ...prev,\n        difficulty: level,\n        ...PRESETS[level]\n    }));\n  };\n\n  const toggleOctave = (octave: number) => {\n    setSettings(prev => {\n        if (prev.selectedOctaves.includes(octave)) {\n            return { ...prev, selectedOctaves: prev.selectedOctaves.filter(o => o !== octave) };\n        } else {\n            return { ...prev, selectedOctaves: [...prev.selectedOctaves, octave] };\n        }\n    });\n  };\n\n  const ROOT_OPTIONS: NoteName[] = ['C', 'C#', 'Db', 'D', 'Eb', 'E', 'F', 'F#', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'];\n\n  const DIFFICULTY_DESCRIPTIONS: Record<number, string> = {\n      1: 'Very Easy: Stepwise motion, short melody',\n      2: 'Easy: Small jumps, simple scale',\n      3: 'Medium: Perfect 5th jumps, limited replays',\n      4: 'Hard: Larger jumps, 2 octaves',\n      5: 'Expert: Full octave jumps, complex melody'\n  };\n\n  return (\n    <div className=\"max-w-xl mx-auto p-6 bg-white rounded-xl shadow-lg mt-10 border border-slate-100 text-slate-900\">\n      <div className=\"flex items-center gap-3 mb-6\">\n        <div className=\"p-3 bg-blue-600 rounded-lg text-white\">\n            <Music size={24} />\n        </div>\n        <h1 className=\"text-2xl font-bold text-slate-800\">New Dictation</h1>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        \n        {/* Difficulty (Stars) */}\n        <div>\n            <label className=\"block text-sm font-medium text-slate-700 mb-2\">Difficulty Level</label>\n            <div className=\"flex flex-col gap-3\">\n                <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-1\">\n                        {[1, 2, 3, 4, 5].map((star) => (\n                            <button\n                                key={star}\n                                type=\"button\"\n                                onClick={() => handleDifficultyChange(star)}\n                                className=\"p-1 focus:outline-none transition-transform hover:scale-110\"\n                            >\n                                <Star \n                                    size={36} \n                                    fill={star <= settings.difficulty ? \"#eab308\" : \"transparent\"} \n                                    className={star <= settings.difficulty ? \"text-yellow-500\" : \"text-slate-300\"} \n                                />\n                            </button>\n                        ))}\n                    </div>\n                </div>\n                <div className=\"bg-slate-50 p-3 rounded-lg border border-slate-100\">\n                     <p className=\"text-sm text-slate-600 font-medium\">\n                        {DIFFICULTY_DESCRIPTIONS[settings.difficulty]}\n                    </p>\n                </div>\n            </div>\n        </div>\n\n        {/* Basic Settings: Key & Scale */}\n        <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n            <label className=\"block text-sm font-medium text-slate-700 mb-2\">Root Note</label>\n            <select \n                className=\"w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n                value={settings.rootNote}\n                onChange={(e) => setSettings({...settings, rootNote: e.target.value as NoteName})}\n            >\n                {ROOT_OPTIONS.map(n => (\n                    <option key={n} value={n}>{n}</option>\n                ))}\n            </select>\n            </div>\n\n            <div>\n            <label className=\"block text-sm font-medium text-slate-700 mb-2\">Scale Type</label>\n            <select \n                className=\"w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none\"\n                value={settings.scaleType}\n                onChange={(e) => setSettings({...settings, scaleType: e.target.value as ScaleType})}\n            >\n                <option value=\"Major\">Major</option>\n                <option value=\"Minor\">Minor</option>\n            </select>\n            </div>\n        </div>\n\n        {/* Advanced Settings Toggle */}\n        <div className=\"border-t border-slate-200 pt-4\">\n            <button\n                type=\"button\"\n                onClick={() => setShowAdvanced(!showAdvanced)}\n                className=\"flex items-center gap-2 text-sm font-semibold text-slate-600 hover:text-blue-600 transition-colors\"\n            >\n                <Settings2 size={16} />\n                Advanced Settings\n                {showAdvanced ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n            </button>\n        </div>\n\n        {/* Advanced Settings Section */}\n        {showAdvanced && (\n            <div className=\"space-y-5 bg-slate-50 p-4 rounded-xl border border-slate-200 animate-in fade-in slide-in-from-top-2\">\n                {/* Replay Limit */}\n                <div>\n                    <label className=\"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2\">Replay Limit</label>\n                    <select \n                        className=\"w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm\"\n                        value={settings.replayLimit}\n                        onChange={(e) => setSettings({...settings, replayLimit: e.target.value === 'infinity' ? 'infinity' : Number(e.target.value)})}\n                    >\n                        <option value=\"infinity\">Unlimited</option>\n                        {[...Array(10)].map((_, i) => (\n                        <option key={i} value={i + 1}>{i + 1} Replays</option>\n                        ))}\n                    </select>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                    {/* Scale Range */}\n                    <div>\n                        <label className=\"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2\">Scale Degrees (3-7)</label>\n                        <input \n                            type=\"number\" min=\"3\" max=\"7\" \n                            className=\"w-full p-2 border border-slate-300 rounded-lg text-sm\"\n                            value={settings.scaleRange}\n                            onChange={(e) => setSettings({...settings, scaleRange: Number(e.target.value)})}\n                        />\n                    </div>\n\n                    {/* Melody Length */}\n                    <div>\n                        <label className=\"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2\">Melody Length</label>\n                        <input \n                            type=\"number\" min=\"3\" max=\"15\" \n                            className=\"w-full p-2 border border-slate-300 rounded-lg text-sm\"\n                            value={settings.melodyNoteCount}\n                            onChange={(e) => setSettings({...settings, melodyNoteCount: Number(e.target.value)})}\n                        />\n                    </div>\n                </div>\n\n                {/* Octave Selection */}\n                <div>\n                    <label className=\"block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2\">Octaves</label>\n                    <div className=\"flex flex-wrap gap-2\">\n                        {[2, 3, 4, 5].map(oct => (\n                            <button\n                                key={oct}\n                                type=\"button\"\n                                onClick={() => toggleOctave(oct)}\n                                className={`px-3 py-1.5 rounded-md text-xs font-medium transition-colors border ${\n                                    settings.selectedOctaves.includes(oct)\n                                        ? 'bg-blue-600 text-white border-blue-600'\n                                        : 'bg-white text-slate-600 border-slate-300 hover:bg-slate-100'\n                                }`}\n                            >\n                                {OCTAVE_LABELS[oct]}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n            </div>\n        )}\n\n        <button \n            type=\"submit\"\n            className=\"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors shadow-sm mt-4\"\n        >\n            <Play size={20} />\n            Start Training\n        </button>\n      </form>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1597, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/core/dictation/AudioClient.ts"],"sourcesContent":["export class AudioClient {\n  private ctx: AudioContext | null = null;\n  private gainNode: GainNode | null = null;\n\n  constructor() {\n    // Lazy initialization to comply with browser autoplay policies\n  }\n\n  private init() {\n    if (!this.ctx) {\n      this.ctx = new (window.AudioContext || (window as any).webkitAudioContext)();\n      this.gainNode = this.ctx.createGain();\n      this.gainNode.connect(this.ctx.destination);\n    }\n    if (this.ctx.state === 'suspended') {\n      this.ctx.resume();\n    }\n  }\n\n  public async playTone(frequency: number, duration: number = 0.5, startTime: number = 0) {\n    this.init();\n    if (!this.ctx || !this.gainNode) return;\n\n    const osc = this.ctx.createOscillator();\n    const gain = this.ctx.createGain();\n\n    // \"Piano-like\" synthesis: Triangle wave with slight exponential decay\n    osc.type = 'triangle';\n    osc.frequency.value = frequency;\n\n    osc.connect(gain);\n    gain.connect(this.ctx.destination);\n\n    const now = this.ctx.currentTime + startTime;\n    \n    // Attack\n    gain.gain.setValueAtTime(0, now);\n    gain.gain.linearRampToValueAtTime(0.6, now + 0.02);\n    // Decay\n    gain.gain.exponentialRampToValueAtTime(0.01, now + duration);\n\n    osc.start(now);\n    osc.stop(now + duration + 0.1);\n  }\n\n  public async playSequence(notes: { frequency: number; duration: number }[]) {\n    this.init();\n    if (!this.ctx) return;\n    \n    let currentTime = 0;\n    const gap = 0.1; // Gap between notes\n\n    notes.forEach(note => {\n      this.playTone(note.frequency, note.duration, currentTime);\n      currentTime += note.duration + gap;\n    });\n  }\n}\n\nexport const audioClient = new AudioClient();"],"names":[],"mappings":";;;;;;AAAO,MAAM;IACH,MAA2B,KAAK;IAChC,WAA4B,KAAK;IAEzC,aAAc;IACZ,+DAA+D;IACjE;IAEQ,OAAO;QACb,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;YACb,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,YAAY,IAAI,AAAC,OAAe,kBAAkB;YACzE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU;YACnC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW;QAC5C;QACA,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,KAAK,aAAa;YAClC,IAAI,CAAC,GAAG,CAAC,MAAM;QACjB;IACF;IAEA,MAAa,SAAS,SAAiB,EAAE,WAAmB,GAAG,EAAE,YAAoB,CAAC,EAAE;QACtF,IAAI,CAAC,IAAI;QACT,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;QAEjC,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,gBAAgB;QACrC,MAAM,OAAO,IAAI,CAAC,GAAG,CAAC,UAAU;QAEhC,sEAAsE;QACtE,IAAI,IAAI,GAAG;QACX,IAAI,SAAS,CAAC,KAAK,GAAG;QAEtB,IAAI,OAAO,CAAC;QACZ,KAAK,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW;QAEjC,MAAM,MAAM,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG;QAEnC,SAAS;QACT,KAAK,IAAI,CAAC,cAAc,CAAC,GAAG;QAC5B,KAAK,IAAI,CAAC,uBAAuB,CAAC,KAAK,MAAM;QAC7C,QAAQ;QACR,KAAK,IAAI,CAAC,4BAA4B,CAAC,MAAM,MAAM;QAEnD,IAAI,KAAK,CAAC;QACV,IAAI,IAAI,CAAC,MAAM,WAAW;IAC5B;IAEA,MAAa,aAAa,KAAgD,EAAE;QAC1E,IAAI,CAAC,IAAI;QACT,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;QAEf,IAAI,cAAc;QAClB,MAAM,MAAM,KAAK,oBAAoB;QAErC,MAAM,OAAO,CAAC,CAAA;YACZ,IAAI,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE,KAAK,QAAQ,EAAE;YAC7C,eAAe,KAAK,QAAQ,GAAG;QACjC;IACF;AACF;AAEO,MAAM,cAAc,IAAI"}},
    {"offset": {"line": 1654, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/features/dictation/components/Stave.tsx"],"sourcesContent":["import React from 'react';\nimport { Note, StaveNote, NoteName } from '../../../core/dictation/types';\n\ninterface StaveProps {\n  notes: StaveNote[];\n  interactive?: boolean;\n  selectedNoteId?: string | null;\n  onNoteClick?: (id: string) => void;\n  scaleRoot?: NoteName;\n}\n\nconst LINE_SPACING = 20; // Pixels between staff lines\nconst TOP_MARGIN = 150; // Increased margin to fit high notes (Octave 5)\nconst STAVE_WIDTH = 800;\nconst VIEWBOX_HEIGHT = 350; // Reduced height to be more compact\n\nexport const Stave: React.FC<StaveProps> = ({ \n  notes, \n  interactive, \n  selectedNoteId,\n  onNoteClick \n}) => {\n  \n  // Calculate Y position based on MIDI pitch\n  // We use B3 (MIDI 59) as the visual center (Middle Line of Treble Clef, though technically B4 is middle of staff)\n  // Let's stick to standard Treble Clef alignment for visual familiarity.\n  // Treble Clef: Bottom line is E4 (MIDI 64). Middle line is B4 (MIDI 71).\n  // This is too high for Great/Small octaves.\n  // Previous implementation centered B3 (MIDI 59) on middle line.\n  // Let's keep B3 as middle line reference (Line 3, index 2).\n  // Middle line Y = TOP_MARGIN + 2 * LINE_SPACING.\n  \n  const getNoteY = (midi: number) => {\n    // Reference Note: B3 (59) at Middle Line\n    const refMidi = 59; \n    \n    // Calculate semitone difference\n    const semitoneDiff = midi - refMidi;\n    \n    // We need to map semitones to visual steps. \n    // Diatonic scale steps approx.\n    // C(0), D(2), E(4), F(5), G(7), A(9), B(11)\n    const diatonicSteps = [0, 1, 1, 2, 2, 3, 3, 4, 5, 5, 6, 6];\n    \n    const getDiatonicIndex = (m: number) => {\n       const octave = Math.floor(m / 12);\n       const note = m % 12;\n       return (octave * 7) + diatonicSteps[note];\n    };\n    \n    const refIndex = getDiatonicIndex(refMidi);\n    const currIndex = getDiatonicIndex(midi);\n    \n    // Positive difference means higher pitch -> Lower Y\n    const stepDiff = currIndex - refIndex;\n    \n    const middleLineY = TOP_MARGIN + (2 * LINE_SPACING);\n    return middleLineY - (stepDiff * (LINE_SPACING / 2));\n  };\n\n  const isSharp = (note: Note) => note.name.includes('#');\n  const isFlat = (note: Note) => note.name.includes('b');\n\n  return (\n    <div \n      className=\"w-full overflow-x-auto bg-white rounded-lg shadow-inner border border-slate-200 p-4\"\n      onClick={() => interactive && onNoteClick && onNoteClick('')}\n    >\n      <svg \n        width=\"100%\" \n        height={VIEWBOX_HEIGHT} \n        viewBox={`0 0 ${Math.max(STAVE_WIDTH, notes.length * 60 + 100)} ${VIEWBOX_HEIGHT}`}\n        className=\"min-w-[600px]\"\n      >\n        {/* Draw Stave Lines */}\n        {[0, 1, 2, 3, 4].map(i => (\n          <line \n            key={i}\n            x1=\"10\" \n            x2=\"100%\" \n            y1={TOP_MARGIN + i * LINE_SPACING} \n            y2={TOP_MARGIN + i * LINE_SPACING} \n            stroke=\"#333\" \n            strokeWidth=\"1.5\" \n          />\n        ))}\n\n        {/* Notes */}\n        {notes.map((note, index) => {\n          const x = 60 + (index * 60);\n          const y = getNoteY(note.midi);\n          const sharp = isSharp(note);\n          const flat = isFlat(note);\n          const isSelected = note.id === selectedNoteId;\n          \n          // Ledger Lines Logic\n          const staffTop = TOP_MARGIN;\n          const staffBottom = TOP_MARGIN + 4 * LINE_SPACING;\n          \n          // A note needs ledger lines if it is above top line (y < staffTop)\n          // or below bottom line (y > staffBottom).\n          // We must draw lines at intervals of LINE_SPACING relative to staff.\n          \n          const ledgerLines = [];\n          \n          if (y < staffTop - 5) {\n             // Notes above staff\n             // Draw lines starting from Top - Spacing, upwards to y\n             for (let ly = staffTop - LINE_SPACING; ly >= y - 5; ly -= LINE_SPACING) {\n                 ledgerLines.push(ly);\n             }\n          } else if (y > staffBottom + 5) {\n             // Notes below staff\n             // Draw lines starting from Bottom + Spacing, downwards to y\n             for (let ly = staffBottom + LINE_SPACING; ly <= y + 5; ly += LINE_SPACING) {\n                 ledgerLines.push(ly);\n             }\n          }\n\n          const baseColor = note.isError \n            ? \"#ef4444\" // red-500\n            : \"#0f172a\"; // slate-900\n            \n          const noteColor = isSelected && !note.isError ? \"#3b82f6\" : baseColor;\n\n          return (\n            <g \n                key={note.id || index} \n                className={interactive ? \"cursor-pointer transition-all duration-200\" : \"\"}\n                onClick={(e) => {\n                  e.stopPropagation();\n                  interactive && onNoteClick && onNoteClick(note.id);\n                }}\n            >\n              {/* Ledger Lines */}\n              {ledgerLines.map(ly => (\n                <line \n                    key={ly}\n                    x1={x - 14} x2={x + 14} \n                    y1={ly} y2={ly} \n                    stroke={isSelected ? noteColor : \"#333\"} \n                    strokeWidth=\"1\"\n                />\n              ))}\n\n              {/* Selection Halo */}\n              {isSelected && (\n                <ellipse \n                  cx={x} \n                  cy={y} \n                  rx=\"18\" \n                  ry=\"35\" \n                  fill=\"rgba(59, 130, 246, 0.2)\"\n                />\n              )}\n\n              {/* Note Head */}\n              <ellipse \n                cx={x} \n                cy={y} \n                rx=\"8\" \n                ry=\"6\" \n                fill={noteColor}\n                transform={`rotate(-10 ${x} ${y})`}\n              />\n              \n              {/* Note Stem */}\n              <line \n                x1={y > TOP_MARGIN + 2 * LINE_SPACING ? x + 7 : x - 7} \n                y1={y} \n                x2={y > TOP_MARGIN + 2 * LINE_SPACING ? x + 7 : x - 7} \n                y2={y > TOP_MARGIN + 2 * LINE_SPACING ? y - 35 : y + 35} \n                stroke={noteColor} \n                strokeWidth=\"2\"\n              />\n\n              {/* Accidental (Sharp) */}\n              {sharp && (\n                <text x={x - 20} y={y + 5} fontSize=\"18\" fill={noteColor}>♯</text>\n              )}\n              {/* Accidental (Flat) */}\n              {flat && (\n                <text x={x - 20} y={y + 5} fontSize=\"20\" fill={noteColor}>♭</text>\n              )}\n            </g>\n          );\n        })}\n      </svg>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1864, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/features/dictation/components/PianoKeyboard.tsx"],"sourcesContent":["import React, { useMemo } from 'react';\nimport { Note, NoteName } from '../../../core/dictation/types';\nimport { NOTE_NAMES_SHARP } from '../../../core/dictation/musicTheory';\n\ninterface PianoKeyboardProps {\n  octaves: number[]; // Selected octaves\n  scaleNotes?: Note[];\n  onNoteClick: (note: Note, isScaleNote: boolean) => void;\n  disableNonScaleNotes?: boolean;\n}\n\nexport const PianoKeyboard: React.FC<PianoKeyboardProps> = ({\n  octaves: selectedOctaves,\n  scaleNotes = [],\n  onNoteClick,\n  disableNonScaleNotes = false,\n}) => {\n  // Always render octaves [2, 3, 4, 5] in two rows\n  const PIANO_ROWS = [\n    [2, 3],\n    [4, 5]\n  ];\n\n  return (\n    <div className=\"space-y-4 select-none\">\n      {PIANO_ROWS.map((rowOctaves, idx) => (\n        <div key={idx} className=\"bg-slate-800 p-2 md:p-4 rounded-xl shadow-inner flex overflow-x-auto pb-4 custom-scrollbar justify-center\">\n          {/* Flex container for octaves */}\n          <div className=\"flex\">\n            {rowOctaves.map(octave => (\n              <PianoOctave \n                key={octave} \n                octave={octave} \n                scaleNotes={scaleNotes} \n                onKeyClick={onNoteClick}\n                isSelected={selectedOctaves.includes(octave)}\n                restrictToScale={disableNonScaleNotes}\n              />\n            ))}\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n};\n\n// Sub-component for Piano Keys\nconst PianoOctave: React.FC<{ \n    octave: number, \n    scaleNotes: Note[], \n    onKeyClick: (note: Note, isScale: boolean) => void,\n    isSelected: boolean,\n    restrictToScale: boolean\n}> = ({ octave, scaleNotes, onKeyClick, isSelected, restrictToScale }) => {\n    \n    // Generate full chromatic notes for this octave\n    const keys = useMemo(() => {\n        const whiteKeys = [];\n        const blackKeys = [];\n        \n        // Standard MIDI for Octave: C starts at (octave + 1) * 12\n        const baseMidi = (octave + 1) * 12;\n        \n        // Helper to find if this note is in our generated scale\n        const getScaleNote = (midi: number) => scaleNotes.find(n => n.midi === midi);\n        const createNote = (midi: number, name: string) => {\n             const sn = getScaleNote(midi);\n             return {\n                 midi,\n                 note: sn || { \n                    name: name as NoteName, \n                    midi, \n                    octave, \n                    frequency: 440 * Math.pow(2, (midi - 69) / 12) \n                 },\n                 inScale: !!sn,\n                 label: name\n             };\n        };\n\n        // White keys: 0, 2, 4, 5, 7, 9, 11 relative to base\n        // Indices: 0-6\n        const whiteKeyMidis = [0, 2, 4, 5, 7, 9, 11];\n        const whiteKeyNames = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];\n\n        whiteKeyMidis.forEach((offset, idx) => {\n            whiteKeys.push(createNote(baseMidi + offset, whiteKeyNames[idx]));\n        });\n\n        // Black keys: 1(C#), 3(D#), 6(F#), 8(G#), 10(A#)\n        // We need to know which \"border\" they sit on.\n        // C# sits between C(0) and D(1) -> Offset 1 (100/7 * 1)\n        // D# sits between D(1) and E(2) -> Offset 2\n        // F# sits between F(3) and G(4) -> Offset 4\n        // G# sits between G(4) and A(5) -> Offset 5\n        // A# sits between A(5) and B(6) -> Offset 6\n        \n        const blackDefinitions = [\n            { midiOffset: 1, name: 'C#', positionIndex: 1 },\n            { midiOffset: 3, name: 'D#', positionIndex: 2 },\n            { midiOffset: 6, name: 'F#', positionIndex: 4 },\n            { midiOffset: 8, name: 'G#', positionIndex: 5 },\n            { midiOffset: 10, name: 'A#', positionIndex: 6 },\n        ];\n\n        blackDefinitions.forEach(def => {\n            blackKeys.push({\n                ...createNote(baseMidi + def.midiOffset, def.name),\n                positionIndex: def.positionIndex\n            });\n        });\n\n        return { whites: whiteKeys, blacks: blackKeys };\n    }, [octave, scaleNotes]);\n\n    return (\n        <div className={`relative flex flex-none w-[240px] md:w-[280px] h-32 md:h-40 ${isSelected ? '' : 'opacity-60 grayscale-[0.5]'}`}>\n            {/* White Keys Container */}\n            {keys.whites.map((k) => {\n                const isInteractive = k.inScale || (isSelected && !restrictToScale);\n                const isScaleVisual = k.inScale;\n                \n                return (\n                <button\n                    key={k.midi}\n                    onClick={() => onKeyClick(k.note, k.inScale)}\n                    disabled={!isInteractive}\n                    className={`\n                        flex-1\n                        border-r border-slate-300 last:border-r-0 rounded-b-md \n                        flex items-end justify-center pb-2\n                        transition-all duration-100 text-xs font-bold\n                        ${isScaleVisual\n                            ? 'bg-white text-slate-900 active:bg-slate-100 shadow-[inset_0_-5px_0_rgba(0,0,0,0.1)] active:shadow-none active:translate-y-[2px]' \n                            : isInteractive\n                                ? 'bg-slate-100 text-slate-400 active:bg-slate-200 shadow-[inset_0_-3px_0_rgba(0,0,0,0.05)] active:shadow-none' \n                                : 'bg-slate-300 text-slate-400 opacity-50 cursor-not-allowed'\n                        }\n                    `}\n                >\n                    <span className=\"mb-1 pointer-events-none\">{isScaleVisual && k.label}</span>\n                </button>\n            )})}\n            \n            {/* Black Keys Overlay */}\n            {keys.blacks.map((k) => {\n                const isInteractive = k.inScale || (isSelected && !restrictToScale);\n                const isScaleVisual = k.inScale;\n                // Width of black key relative to octave width. \n                // Approx 60% of white key width (100/7). 0.6 * 14.28 = 8.5%\n                const widthPercent = 8.5; \n                // Left position: (index * 100/7) %\n                const leftPercent = k.positionIndex * (100 / 7);\n\n                return (\n                <button\n                    key={k.midi}\n                    onClick={() => onKeyClick(k.note, k.inScale)}\n                    disabled={!isInteractive}\n                    style={{\n                        left: `${leftPercent}%`,\n                        width: `${widthPercent}%`,\n                        height: '60%', // Black keys are shorter\n                        transform: 'translateX(-50%)' // Center on the line\n                    }}\n                    className={`\n                        absolute top-0 z-10\n                        rounded-b-md flex items-end justify-center pb-2\n                        text-[10px] font-bold transition-all duration-100 border border-slate-900\n                        ${isScaleVisual\n                            ? 'bg-slate-900 text-white active:bg-black shadow-[2px_2px_4px_rgba(0,0,0,0.4)] active:shadow-none active:translate-y-[1px]' \n                            : isInteractive\n                                ? 'bg-slate-700 text-slate-300 active:bg-slate-800'\n                                : 'bg-slate-600 text-slate-400 opacity-50 cursor-not-allowed'\n                        }\n                    `}\n                >\n                    <span className=\"pointer-events-none hidden md:block\">{isScaleVisual && k.label}</span>\n                </button>\n            )})}\n        </div>\n    );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2090, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/features/dictation/screens/TrainingScreen.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { GameSettings, StaveNote, Note } from '../../../core/dictation/types';\nimport { generateScale, generateMelody } from '../../../core/dictation/musicTheory';\nimport { audioClient } from '../../../core/dictation/AudioClient';\nimport { Stave } from '../components/Stave';\nimport { PianoKeyboard } from '../components/PianoKeyboard';\nimport { Play, RefreshCw, Check, ArrowLeft, Volume2, Music4, Trash2, Keyboard, X } from 'lucide-react';\n\ninterface TrainingScreenProps {\n  settings: GameSettings;\n  onBack: () => void;\n}\n\nexport const TrainingScreen: React.FC<TrainingScreenProps> = ({ settings, onBack }) => {\n  const [scalePool, setScalePool] = useState<Note[]>([]);\n  const [targetMelody, setTargetMelody] = useState<Note[]>([]);\n  const [userNotes, setUserNotes] = useState<StaveNote[]>([]);\n  const [selectedNoteId, setSelectedNoteId] = useState<string | null>(null);\n  const [playCount, setPlayCount] = useState(0);\n  const [feedback, setFeedback] = useState<'none' | 'success' | 'error'>('none');\n  const [message, setMessage] = useState<string>('');\n  const [inputMode, setInputMode] = useState<'write' | 'trial'>('write');\n  \n  // Counters\n  const [successCount, setSuccessCount] = useState(0);\n  const [errorCount, setErrorCount] = useState(0);\n\n  // Initialize Game\n  useEffect(() => {\n    startNewRound();\n  }, []);\n\n  const startNewRound = () => {\n    const scale = generateScale(settings.rootNote, settings.scaleType, settings.selectedOctaves, settings.scaleRange);\n    const melody = generateMelody(scale, settings.melodyNoteCount, settings.difficulty);\n    \n    setScalePool(scale);\n    setTargetMelody(melody);\n    setUserNotes([]);\n    setSelectedNoteId(null);\n    setPlayCount(0);\n    setFeedback('none');\n    setMessage(`Listen to the ${settings.melodyNoteCount}-note melody.`);\n  };\n\n  const playMelody = async () => {\n    if (settings.replayLimit !== 'infinity' && playCount >= settings.replayLimit) {\n        setMessage(\"Replay limit reached!\");\n        return;\n    }\n\n    setPlayCount(p => p + 1);\n    const sequence = targetMelody.map(n => ({ frequency: n.frequency, duration: 0.6 }));\n    await audioClient.playSequence(sequence);\n  };\n\n  const playScale = async () => {\n    // Play one octave of the scale from the lowest selected\n    if (scalePool.length === 0) return;\n    const startMidi = scalePool[0].midi;\n    // Get first 8 notes if available\n    const sequence = scalePool.filter(n => n.midi < startMidi + 13).map(n => ({ frequency: n.frequency, duration: 0.4 }));\n    await audioClient.playSequence(sequence);\n  };\n\n  const playNote = async (note: Note) => {\n    await audioClient.playTone(note.frequency, 0.4);\n  };\n\n  const handlePianoKeyClick = (note: Note, isScaleNote: boolean) => {\n      if (inputMode === 'trial') {\n        playNote(note);\n        return;\n      }\n\n      // In write mode, we DO NOT play the sound, as requested.\n      \n      // In write mode, only allow scale notes?\n      if (!isScaleNote) {\n          setMessage(\"Note not in scale!\");\n          return; \n      }\n\n      if (feedback === 'success') return; \n      \n      // Reset error states\n      if (feedback === 'error') {\n          setFeedback('none');\n          setUserNotes(prev => prev.map(n => ({ ...n, isError: false })));\n      }\n\n      if (selectedNoteId) {\n          // Replace existing note\n          setUserNotes(prev => prev.map(n => {\n              if (n.id === selectedNoteId) {\n                  return { ...note, id: selectedNoteId }; \n              }\n              return n;\n          }));\n          setSelectedNoteId(null);\n      } else {\n          // Add new note\n          const newId = Math.random().toString(36).substr(2, 9);\n          const newNote: StaveNote = { ...note, id: newId };\n          setUserNotes(prev => [...prev, newNote]);\n      }\n  };\n\n  const handleNoteClick = (id: string) => {\n      if (feedback === 'success') return;\n      setSelectedNoteId(id === selectedNoteId ? null : id); \n  };\n\n  const deleteSelectedNote = () => {\n      if (feedback === 'success' || !selectedNoteId) return;\n      setUserNotes(prev => prev.filter(n => n.id !== selectedNoteId));\n      setSelectedNoteId(null);\n  };\n\n  const clearAllNotes = () => {\n      setUserNotes([]);\n      setSelectedNoteId(null);\n  };\n\n  const checkSolution = () => {\n    setSelectedNoteId(null);\n\n    if (userNotes.length !== targetMelody.length) {\n        setMessage(`Incorrect length. Expected ${targetMelody.length} notes.`);\n        setFeedback('error');\n        setErrorCount(c => c + 1);\n        return;\n    }\n\n    let hasError = false;\n    const checkedNotes = userNotes.map((uNote, index) => {\n        const isCorrect = uNote.midi === targetMelody[index].midi;\n        if (!isCorrect) hasError = true;\n        return { ...uNote, isError: !isCorrect };\n    });\n\n    setUserNotes(checkedNotes);\n\n    if (hasError) {\n        setFeedback('error');\n        setMessage(\"Some notes are incorrect. Tap a red note to correct it.\");\n        setErrorCount(c => c + 1);\n    } else {\n        setFeedback('success');\n        setMessage(\"Correct! Generating new melody...\");\n        setSuccessCount(c => c + 1);\n        const winSequence = [523.25, 659.25, 783.99, 1046.50].map(f => ({frequency: f, duration: 0.1}));\n        audioClient.playSequence(winSequence);\n        setTimeout(startNewRound, 2000);\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto max-w-5xl p-2 md:p-4 text-slate-900\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center mb-4\">\n        <button onClick={onBack} className=\"flex items-center text-slate-500 hover:text-slate-800 text-sm font-medium\">\n            <ArrowLeft size={18} className=\"mr-1\"/> Quit\n        </button>\n        \n        <div className=\"flex gap-3\">\n             <div className=\"flex items-center gap-1.5 px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs font-bold border border-green-200\">\n                 <Check size={14} /> {successCount}\n             </div>\n             <div className=\"flex items-center gap-1.5 px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold border border-red-200\">\n                 <X size={14} /> {errorCount}\n             </div>\n             <div className=\"bg-slate-200 px-3 py-1 rounded-full text-xs font-semibold text-slate-700\">\n                Replays: {settings.replayLimit === 'infinity' ? playCount : `${playCount} / ${settings.replayLimit}`}\n            </div>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n        {/* Left Col: Controls */}\n        <div className=\"lg:col-span-1 space-y-3\">\n            <div className=\"bg-white p-3 rounded-xl shadow-sm border border-slate-200\">\n                <div className=\"flex gap-2\">\n                    <button \n                        onClick={playMelody}\n                        disabled={settings.replayLimit !== 'infinity' && playCount >= settings.replayLimit}\n                        className={`flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-lg font-medium text-sm transition-colors ${\n                            settings.replayLimit !== 'infinity' && playCount >= settings.replayLimit\n                            ? 'bg-slate-100 text-slate-400 cursor-not-allowed'\n                            : 'bg-blue-600 text-white hover:bg-blue-700'\n                        }`}\n                    >\n                        <Play size={18} /> Melody\n                    </button>\n                    \n                    <button \n                        onClick={playScale}\n                        className=\"flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-lg font-medium text-sm bg-indigo-100 text-indigo-700 hover:bg-indigo-200 transition-colors\"\n                    >\n                        <Music4 size={18} /> Scale\n                    </button>\n                </div>\n            </div>\n\n            <div className={`p-3 rounded-xl border text-center transition-colors ${\n                feedback === 'success' ? 'bg-green-50 border-green-200' : \n                feedback === 'error' ? 'bg-red-50 border-red-200' : 'bg-blue-50 border-blue-100'\n            }`}>\n                <p className={`text-sm font-medium ${\n                    feedback === 'success' ? 'text-green-600' : \n                    feedback === 'error' ? 'text-red-500' : 'text-slate-700'\n                }`}>\n                    {message}\n                </p>\n            </div>\n        </div>\n\n        {/* Right Col: Stave & Input */}\n        <div className=\"lg:col-span-2 space-y-4\">\n             <div className=\"bg-white rounded-xl shadow-md overflow-hidden relative\">\n                <Stave \n                    notes={userNotes} \n                    interactive={true} \n                    selectedNoteId={selectedNoteId}\n                    onNoteClick={handleNoteClick} \n                />\n             </div>\n\n             {/* Action Bar */}\n             <div className=\"flex flex-wrap justify-between gap-2 items-center bg-slate-100 p-2 rounded-lg\">\n                <div className=\"flex gap-2\">\n                    <button \n                        onClick={clearAllNotes}\n                        className=\"flex items-center gap-1.5 px-3 py-2 text-slate-600 hover:bg-slate-200 rounded-lg transition-colors text-xs font-medium\"\n                    >\n                        <RefreshCw size={14} /> Clear\n                    </button>\n                    <button \n                        onClick={deleteSelectedNote}\n                        disabled={!selectedNoteId}\n                        className={`flex items-center gap-1.5 px-3 py-2 rounded-lg transition-colors text-xs font-medium ${\n                            selectedNoteId \n                                ? 'bg-red-100 text-red-700 hover:bg-red-200' \n                                : 'text-slate-400 cursor-not-allowed'\n                        }`}\n                    >\n                        <Trash2 size={14} /> Delete\n                    </button>\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                     <button \n                        onClick={() => setInputMode(m => m === 'write' ? 'trial' : 'write')}\n                        className={`flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-bold transition-colors border ${\n                            inputMode === 'write' \n                                ? 'bg-blue-100 text-blue-700 border-blue-200 hover:bg-blue-200' \n                                : 'bg-amber-100 text-amber-700 border-amber-200 hover:bg-amber-200'\n                        }`}\n                    >\n                        {inputMode === 'write' ? <Keyboard size={14}/> : <Volume2 size={14}/>}\n                        {inputMode === 'write' ? 'Write Mode' : 'Trial Mode'}\n                    </button>\n\n                    <button \n                        onClick={checkSolution}\n                        className=\"flex items-center gap-1.5 px-4 py-2 bg-green-600 text-white hover:bg-green-700 rounded-lg text-sm font-semibold shadow-sm transition-transform active:scale-95\"\n                    >\n                        <Check size={16} /> Check\n                    </button>\n                </div>\n             </div>\n\n             {/* Piano Keyboard Component */}\n             <PianoKeyboard \n                octaves={settings.selectedOctaves}\n                scaleNotes={scalePool}\n                onNoteClick={handlePianoKeyClick}\n                disableNonScaleNotes={inputMode === 'write'}\n             />\n        </div>\n      </div>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2592, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/app/dictation/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Header } from '../../shared/components/Header';\nimport { Footer } from '../../shared/components/Footer';\nimport { SetupScreen } from '../../features/dictation/screens/SetupScreen';\nimport { TrainingScreen } from '../../features/dictation/screens/TrainingScreen';\nimport { GameSettings } from '../../core/dictation/types';\nimport { Brain, Music, ArrowLeft, Info } from 'lucide-react';\n\nexport default function DictationPage() {\n  const [gameState, setGameState] = useState<'setup' | 'training'>('setup');\n  const [gameSettings, setGameSettings] = useState<GameSettings | null>(null);\n\n  const handleStartTraining = (settings: GameSettings) => {\n    setGameSettings(settings);\n    setGameState('training');\n  };\n\n  const handleBackToSetup = () => {\n    setGameState('setup');\n    setGameSettings(null);\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-slate-950 text-white\">\n      <Header />\n      \n      <main className=\"flex-grow container mx-auto px-4 py-8\">\n        {gameState === 'setup' && (\n          <>\n            {/* Page Header */}\n            <div className=\"text-center mb-8\">\n              <div className=\"flex justify-center mb-4\">\n                <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 p-3 rounded-xl\">\n                  <Brain className=\"text-white\" size={32} />\n                </div>\n              </div>\n              <h1 className=\"text-3xl md:text-4xl font-bold mb-4 bg-gradient-to-r from-white to-purple-400 bg-clip-text text-transparent\">\n                Музыкальный диктант\n              </h1>\n              <p className=\"text-slate-400 max-w-2xl mx-auto\">\n                Развивайте музыкальный слух и способность распознавать ноты. \n                Тренируйтесь определять мелодии на слух в интерактивном формате.\n              </p>\n            </div>\n\n            {/* Instructions */}\n            <div className=\"bg-slate-800/30 border border-white/10 rounded-lg p-4 mb-8 max-w-2xl mx-auto\">\n              <div className=\"flex items-start gap-3\">\n                <Info className=\"text-purple-400 mt-0.5\" size={20} />\n                <div className=\"text-sm text-slate-300\">\n                  <p className=\"font-medium mb-1\">Как это работает:</p>\n                  <ul className=\"list-disc list-inside space-y-1 text-slate-400\">\n                    <li>Настройте уровень сложности и параметры тренировки</li>\n                    <li>Прослушайте мелодию, которая будет воспроизведена</li>\n                    <li>Определите ноты и воспроизведите мелодию на пианино</li>\n                    <li>Проверьте свой результат и переходите к следующему упражнению</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n\n            {/* Setup Screen */}\n            <SetupScreen onStart={handleStartTraining} />\n          </>\n        )}\n\n        {gameState === 'training' && gameSettings && (\n          <TrainingScreen \n            settings={gameSettings} \n            onBack={handleBackToSetup} \n          />\n        )}\n      </main>\n      \n      <Footer />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAEA;AAAA;AARA;;;;;;;;AAUe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAuB;IACjE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAsB;IAEtE,MAAM,sBAAsB,CAAC;QAC3B,gBAAgB;QAChB,aAAa;IACf;IAEA,MAAM,oBAAoB;QACxB,aAAa;QACb,gBAAgB;IAClB;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,gJAAM;;;;;0BAEP,8OAAC;gBAAK,WAAU;;oBACb,cAAc,yBACb;;0CAEE,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC;4CAAI,WAAU;sDACb,cAAA,8OAAC,6MAAK;gDAAC,WAAU;gDAAa,MAAM;;;;;;;;;;;;;;;;kDAGxC,8OAAC;wCAAG,WAAU;kDAA8G;;;;;;kDAG5H,8OAAC;wCAAE,WAAU;kDAAmC;;;;;;;;;;;;0CAOlD,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,0MAAI;4CAAC,WAAU;4CAAyB,MAAM;;;;;;sDAC/C,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAE,WAAU;8DAAmB;;;;;;8DAChC,8OAAC;oDAAG,WAAU;;sEACZ,8OAAC;sEAAG;;;;;;sEACJ,8OAAC;sEAAG;;;;;;sEACJ,8OAAC;sEAAG;;;;;;sEACJ,8OAAC;sEAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0CAOZ,8OAAC,sKAAW;gCAAC,SAAS;;;;;;;;oBAIzB,cAAc,cAAc,8BAC3B,8OAAC,4KAAc;wBACb,UAAU;wBACV,QAAQ;;;;;;;;;;;;0BAKd,8OAAC,gJAAM;;;;;;;;;;;AAGb"}}]
}