{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/store/slices/playerSlice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Measure, StrumStep } from '../../domain/entities';\n\ninterface PlayerState {\n  bpm: number;\n  isPlaying: boolean;\n  measures: Measure[];\n  activeMeasureIdx: number;\n  currentDisplayStepIdx: number | null;\n  globalStrumPattern: StrumStep[];\n  hasUnsavedChanges: boolean;\n}\n\nconst generateSteps = (count: number, chord: string = 'Am'): StrumStep[] => {\n  return Array.from({ length: count }, (_, i) => ({\n    id: `step-${Date.now()}-${i}`,\n    direction: i % 2 === 0 ? 'down' : 'up',\n    strumType: (i === 0 || i === 2 || i === 4 || i === 6) ? 'strum' : 'ghost',\n    chord: chord,\n    lyrics: ''\n  }));\n};\n\nconst createMeasure = (id: number, chord: string = 'Am'): Measure => ({\n  id: `measure-${Date.now()}-${id}`,\n  steps: generateSteps(8, chord)\n});\n\nconst initialState: PlayerState = {\n  bpm: 90,\n  isPlaying: false,\n  measures: [createMeasure(0, 'Am')],\n  activeMeasureIdx: 0,\n  currentDisplayStepIdx: null,\n  globalStrumPattern: [],\n  hasUnsavedChanges: false,\n};\n\nconst playerSlice = createSlice({\n  name: 'player',\n  initialState,\n  reducers: {\n    setBpm: (state, action: PayloadAction<number>) => {\n      state.bpm = action.payload;\n    },\n    setIsPlaying: (state, action: PayloadAction<boolean>) => {\n      state.isPlaying = action.payload;\n    },\n    setActiveMeasureIdx: (state, action: PayloadAction<number>) => {\n      state.activeMeasureIdx = action.payload;\n    },\n    setCurrentDisplayStepIdx: (state, action: PayloadAction<number | null>) => {\n      state.currentDisplayStepIdx = action.payload;\n    },\n    addMeasure: (state) => {\n      const currentMeasure = state.measures[state.activeMeasureIdx];\n      const newMeasure: Measure = {\n        id: `measure-${Date.now()}-${state.measures.length}`,\n        steps: currentMeasure.steps.map(step => ({\n          ...step,\n          id: `step-${Date.now()}-${Math.random()}`\n        }))\n      };\n      \n      state.measures.splice(state.activeMeasureIdx + 1, 0, newMeasure);\n      state.activeMeasureIdx += 1;\n    },\n    removeMeasure: (state) => {\n      if (state.measures.length <= 1) return;\n      \n      state.measures = state.measures.filter((_, i) => i !== state.activeMeasureIdx);\n      state.activeMeasureIdx = Math.max(0, state.activeMeasureIdx - 1);\n    },\n    updateChordForMeasure: (state, action: PayloadAction<string>) => {\n      const chord = action.payload;\n      state.measures = state.measures.map((m, i) => {\n        if (i === state.activeMeasureIdx) {\n          return {\n            ...m,\n            steps: m.steps.map(s => ({ ...s, chord }))\n          };\n        }\n        return m;\n      });\n    },\n    updateStep: (state, action: PayloadAction<{measureIdx: number, stepIdx: number, updates: Partial<StrumStep>}>) => {\n      const { measureIdx, stepIdx, updates } = action.payload;\n      state.measures = state.measures.map((m, i) => {\n        if (i === measureIdx) {\n          const newSteps = [...m.steps];\n          newSteps[stepIdx] = { ...newSteps[stepIdx], ...updates };\n          return { ...m, steps: newSteps };\n        }\n        return m;\n      });\n      \n      if (measureIdx === state.activeMeasureIdx) {\n        state.hasUnsavedChanges = true;\n      }\n    },\n    applyToAllMeasures: (state) => {\n      const currentMeasure = state.measures[state.activeMeasureIdx];\n      if (!currentMeasure) return;\n      \n      state.globalStrumPattern = [...currentMeasure.steps];\n      \n      state.measures = state.measures.map(m => {\n        const currentChord = m.steps[0]?.chord || 'Am';\n        let newSteps = [];\n        \n        if (currentMeasure.steps.length > m.steps.length) {\n          newSteps = [...m.steps];\n          const stepsToAdd = currentMeasure.steps.length - m.steps.length;\n          for (let i = 0; i < stepsToAdd; i++) {\n            newSteps.push({\n              id: `step-added-${Date.now()}-${i}`,\n              direction: (m.steps.length + i) % 2 === 0 ? 'down' : 'up',\n              strumType: 'ghost',\n              chord: currentChord,\n              lyrics: ''\n            });\n          }\n        } else {\n          newSteps = m.steps.slice(0, currentMeasure.steps.length);\n        }\n        \n        newSteps = newSteps.map((step, idx) => ({\n          ...step,\n          strumType: currentMeasure.steps[idx].strumType\n        }));\n        \n        return {\n          ...m,\n          steps: newSteps\n        };\n      });\n      \n      state.hasUnsavedChanges = false;\n    },\n    saveOnlyInThisMeasure: (state) => {\n      state.hasUnsavedChanges = false;\n    },\n    changeStepCount: (state, action: PayloadAction<number>) => {\n      const delta = action.payload;\n      state.measures = state.measures.map((m, i) => {\n        if (i === state.activeMeasureIdx) {\n          const currentLen = m.steps.length;\n          const newLen = Math.max(4, Math.min(16, currentLen + delta));\n          const currentChord = m.steps[0]?.chord || 'Am';\n          \n          if (newLen === currentLen) return m;\n          \n          let newSteps = [...m.steps];\n          if (newLen > currentLen) {\n            const added = Array.from({ length: newLen - currentLen }, (_, k) => ({\n              id: `step-added-${Date.now()}-${k}`,\n              direction: ((currentLen + k) % 2 === 0 ? 'down' : 'up') as 'down' | 'up',\n              strumType: 'ghost' as const,\n              chord: currentChord,\n              lyrics: ''\n            }));\n            newSteps = [...newSteps, ...added];\n          } else {\n            newSteps = newSteps.slice(0, newLen);\n          }\n          \n          state.hasUnsavedChanges = true;\n          \n          return { ...m, steps: newSteps };\n        }\n        return m;\n      });\n    },\n    reset: (state) => {\n      state.isPlaying = false;\n      state.currentDisplayStepIdx = null;\n    }\n  }\n});\n\nexport const {\n  setBpm,\n  setIsPlaying,\n  setActiveMeasureIdx,\n  setCurrentDisplayStepIdx,\n  addMeasure,\n  removeMeasure,\n  updateChordForMeasure,\n  updateStep,\n  applyToAllMeasures,\n  saveOnlyInThisMeasure,\n  changeStepCount,\n  reset\n} = playerSlice.actions;\n\nexport default playerSlice.reducer;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/store/slices/tunerSlice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { TunerResult } from '../../domain/entities';\n\nexport type TunerMode = 'chromatic' | 'guitar';\n\ninterface TunerState {\n  isOpen: boolean;\n  isRunning: boolean;\n  currentNote: string;\n  currentFrequency: number;\n  currentDetune: number;\n  pointerPosition: number;\n  isInTune: boolean;\n  mode: TunerMode;\n  error: string | null;\n}\n\nconst initialState: TunerState = {\n  isOpen: false,\n  isRunning: false,\n  currentNote: \"-\",\n  currentFrequency: 0,\n  currentDetune: 0,\n  pointerPosition: 50,\n  isInTune: false,\n  mode: 'chromatic',\n  error: null,\n};\n\nconst tunerSlice = createSlice({\n  name: 'tuner',\n  initialState,\n  reducers: {\n    openTuner: (state) => {\n      state.isOpen = true;\n      state.error = null;\n    },\n    closeTuner: (state) => {\n      state.isOpen = false;\n      state.isRunning = false;\n    },\n    setTunerMode: (state, action: PayloadAction<TunerMode>) => {\n      state.mode = action.payload;\n      // Reset UI when mode changes\n      state.currentNote = \"-\";\n      state.isInTune = false;\n      state.currentFrequency = 0;\n      state.currentDetune = 0;\n      state.pointerPosition = 50;\n    },\n    startTuner: (state) => {\n      state.isRunning = true;\n      state.error = null;\n    },\n    stopTuner: (state) => {\n      state.isRunning = false;\n      // Reset UI when stopping\n      state.currentNote = \"-\";\n      state.isInTune = false;\n      state.currentFrequency = 0;\n      state.currentDetune = 0;\n      state.pointerPosition = 50;\n    },\n    updateTunerResult: (state, action: PayloadAction<TunerResult>) => {\n      const { note, frequency, cents, isInTune } = action.payload;\n      \n      state.currentNote = note;\n      state.currentFrequency = frequency;\n      state.currentDetune = cents;\n      state.isInTune = isInTune;\n      \n      // Convert cents (-50 to +50) to percentage (0% to 100%)\n      let percent = 50 + cents;\n      \n      // Clamp values\n      if (percent < 0) percent = 0;\n      if (percent > 100) percent = 100;\n      \n      state.pointerPosition = percent;\n    },\n    setTunerError: (state, action: PayloadAction<string>) => {\n      state.error = action.payload;\n      state.isRunning = false;\n    },\n    clearTunerError: (state) => {\n      state.error = null;\n    }\n  }\n});\n\nexport const {\n  openTuner,\n  closeTuner,\n  setTunerMode,\n  startTuner,\n  stopTuner,\n  updateTunerResult,\n  setTunerError,\n  clearTunerError\n} = tunerSlice.actions;\n\nexport default tunerSlice.reducer;"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;AAiBA,MAAM,eAA2B;IAC/B,QAAQ;IACR,WAAW;IACX,aAAa;IACb,kBAAkB;IAClB,eAAe;IACf,iBAAiB;IACjB,UAAU;IACV,MAAM;IACN,OAAO;AACT;AAEA,MAAM,aAAa,IAAA,6MAAW,EAAC;IAC7B,MAAM;IACN;IACA,UAAU;QACR,WAAW,CAAC;YACV,MAAM,MAAM,GAAG;YACf,MAAM,KAAK,GAAG;QAChB;QACA,YAAY,CAAC;YACX,MAAM,MAAM,GAAG;YACf,MAAM,SAAS,GAAG;QACpB;QACA,cAAc,CAAC,OAAO;YACpB,MAAM,IAAI,GAAG,OAAO,OAAO;YAC3B,6BAA6B;YAC7B,MAAM,WAAW,GAAG;YACpB,MAAM,QAAQ,GAAG;YACjB,MAAM,gBAAgB,GAAG;YACzB,MAAM,aAAa,GAAG;YACtB,MAAM,eAAe,GAAG;QAC1B;QACA,YAAY,CAAC;YACX,MAAM,SAAS,GAAG;YAClB,MAAM,KAAK,GAAG;QAChB;QACA,WAAW,CAAC;YACV,MAAM,SAAS,GAAG;YAClB,yBAAyB;YACzB,MAAM,WAAW,GAAG;YACpB,MAAM,QAAQ,GAAG;YACjB,MAAM,gBAAgB,GAAG;YACzB,MAAM,aAAa,GAAG;YACtB,MAAM,eAAe,GAAG;QAC1B;QACA,mBAAmB,CAAC,OAAO;YACzB,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,OAAO;YAE3D,MAAM,WAAW,GAAG;YACpB,MAAM,gBAAgB,GAAG;YACzB,MAAM,aAAa,GAAG;YACtB,MAAM,QAAQ,GAAG;YAEjB,wDAAwD;YACxD,IAAI,UAAU,KAAK;YAEnB,eAAe;YACf,IAAI,UAAU,GAAG,UAAU;YAC3B,IAAI,UAAU,KAAK,UAAU;YAE7B,MAAM,eAAe,GAAG;QAC1B;QACA,eAAe,CAAC,OAAO;YACrB,MAAM,KAAK,GAAG,OAAO,OAAO;YAC5B,MAAM,SAAS,GAAG;QACpB;QACA,iBAAiB,CAAC;YAChB,MAAM,KAAK,GAAG;QAChB;IACF;AACF;AAEO,MAAM,EACX,SAAS,EACT,UAAU,EACV,YAAY,EACZ,UAAU,EACV,SAAS,EACT,iBAAiB,EACjB,aAAa,EACb,eAAe,EAChB,GAAG,WAAW,OAAO;uCAEP,WAAW,OAAO"}},
    {"offset": {"line": 320, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/entities/measure/model/slice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Measure, StrumStep } from '../../../domain/entities';\n\ninterface MeasureState {\n  measures: Measure[];\n  activeMeasureIdx: number;\n  globalStrumPattern: StrumStep[];\n  hasUnsavedChanges: boolean;\n}\n\nconst generateSteps = (count: number, chord: string = 'Am'): StrumStep[] => {\n  return Array.from({ length: count }, (_, i) => ({\n    id: `step-${Date.now()}-${i}`,\n    direction: i % 2 === 0 ? 'down' : 'up',\n    strumType: (i === 0 || i === 2 || i === 4 || i === 6) ? 'strum' : 'ghost',\n    chord: chord,\n    lyrics: ''\n  }));\n};\n\nconst createMeasure = (id: number, chord: string = 'Am'): Measure => ({\n  id: `measure-${Date.now()}-${id}`,\n  steps: generateSteps(8, chord)\n});\n\nconst initialState: MeasureState = {\n  measures: [createMeasure(0, 'Am')],\n  activeMeasureIdx: 0,\n  globalStrumPattern: [],\n  hasUnsavedChanges: false,\n};\n\nexport const measureSlice = createSlice({\n  name: 'measure',\n  initialState,\n  reducers: {\n    setActiveMeasureIdx: (state, action: PayloadAction<number>) => {\n      state.activeMeasureIdx = action.payload;\n    },\n    addMeasure: (state) => {\n      const currentMeasure = state.measures[state.activeMeasureIdx];\n      const newMeasure: Measure = {\n        id: `measure-${Date.now()}-${state.measures.length}`,\n        steps: currentMeasure.steps.map(step => ({\n          ...step,\n          id: `step-${Date.now()}-${Math.random()}`\n        }))\n      };\n      \n      state.measures.splice(state.activeMeasureIdx + 1, 0, newMeasure);\n      state.activeMeasureIdx += 1;\n    },\n    removeMeasure: (state) => {\n      if (state.measures.length <= 1) return;\n      \n      state.measures = state.measures.filter((_, i) => i !== state.activeMeasureIdx);\n      state.activeMeasureIdx = Math.max(0, state.activeMeasureIdx - 1);\n    },\n    updateChordForMeasure: (state, action: PayloadAction<string>) => {\n      const chord = action.payload;\n      state.measures = state.measures.map((m, i) => {\n        if (i === state.activeMeasureIdx) {\n          return {\n            ...m,\n            steps: m.steps.map(s => ({ ...s, chord }))\n          };\n        }\n        return m;\n      });\n    },\n    updateStep: (state, action: PayloadAction<{measureIdx: number, stepIdx: number, updates: Partial<StrumStep>}>) => {\n      const { measureIdx, stepIdx, updates } = action.payload;\n      state.measures = state.measures.map((m, i) => {\n        if (i === measureIdx) {\n          const newSteps = [...m.steps];\n          newSteps[stepIdx] = { ...newSteps[stepIdx], ...updates };\n          return { ...m, steps: newSteps };\n        }\n        return m;\n      });\n      \n      if (measureIdx === state.activeMeasureIdx) {\n        state.hasUnsavedChanges = true;\n      }\n    },\n    applyToAllMeasures: (state) => {\n      const currentMeasure = state.measures[state.activeMeasureIdx];\n      if (!currentMeasure) return;\n      \n      state.globalStrumPattern = [...currentMeasure.steps];\n      \n      state.measures = state.measures.map(m => {\n        const currentChord = m.steps[0]?.chord || 'Am';\n        let newSteps = [];\n        \n        if (currentMeasure.steps.length > m.steps.length) {\n          newSteps = [...m.steps];\n          const stepsToAdd = currentMeasure.steps.length - m.steps.length;\n          for (let i = 0; i < stepsToAdd; i++) {\n            newSteps.push({\n              id: `step-added-${Date.now()}-${i}`,\n              direction: (m.steps.length + i) % 2 === 0 ? 'down' : 'up',\n              strumType: 'ghost',\n              chord: currentChord,\n              lyrics: ''\n            });\n          }\n        } else {\n          newSteps = m.steps.slice(0, currentMeasure.steps.length);\n        }\n        \n        newSteps = newSteps.map((step, idx) => ({\n          ...step,\n          strumType: currentMeasure.steps[idx].strumType\n        }));\n        \n        return {\n          ...m,\n          steps: newSteps\n        };\n      });\n      \n      state.hasUnsavedChanges = false;\n    },\n    saveOnlyInThisMeasure: (state) => {\n      state.hasUnsavedChanges = false;\n    },\n    changeStepCount: (state, action: PayloadAction<number>) => {\n      const delta = action.payload;\n      state.measures = state.measures.map((m, i) => {\n        if (i === state.activeMeasureIdx) {\n          const currentLen = m.steps.length;\n          const newLen = Math.max(4, Math.min(16, currentLen + delta));\n          const currentChord = m.steps[0]?.chord || 'Am';\n          \n          if (newLen === currentLen) return m;\n          \n          let newSteps = [...m.steps];\n          if (newLen > currentLen) {\n            const added = Array.from({ length: newLen - currentLen }, (_, k) => ({\n              id: `step-added-${Date.now()}-${k}`,\n              direction: ((currentLen + k) % 2 === 0 ? 'down' : 'up') as 'down' | 'up',\n              strumType: 'ghost' as const,\n              chord: currentChord,\n              lyrics: ''\n            }));\n            newSteps = [...newSteps, ...added];\n          } else {\n            newSteps = newSteps.slice(0, newLen);\n          }\n          \n          state.hasUnsavedChanges = true;\n          \n          return { ...m, steps: newSteps };\n        }\n        return m;\n      });\n    },\n  }\n});\n\nexport const {\n  setActiveMeasureIdx,\n  addMeasure,\n  removeMeasure,\n  updateChordForMeasure,\n  updateStep,\n  applyToAllMeasures,\n  saveOnlyInThisMeasure,\n  changeStepCount\n} = measureSlice.actions;\n\nexport default measureSlice.reducer;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/entities/instrument/model/slice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\ninterface InstrumentState {\n  bpm: number;\n  isPlaying: boolean;\n  currentDisplayStepIdx: number | null;\n}\n\nconst initialState: InstrumentState = {\n  bpm: 90,\n  isPlaying: false,\n  currentDisplayStepIdx: null,\n};\n\nexport const instrumentSlice = createSlice({\n  name: 'instrument',\n  initialState,\n  reducers: {\n    setBpm: (state, action: PayloadAction<number>) => {\n      state.bpm = action.payload;\n    },\n    setIsPlaying: (state, action: PayloadAction<boolean>) => {\n      state.isPlaying = action.payload;\n    },\n    setCurrentDisplayStepIdx: (state, action: PayloadAction<number | null>) => {\n      state.currentDisplayStepIdx = action.payload;\n    },\n    reset: (state) => {\n      state.isPlaying = false;\n      state.currentDisplayStepIdx = null;\n    }\n  }\n});\n\nexport const {\n  setBpm,\n  setIsPlaying,\n  setCurrentDisplayStepIdx,\n  reset\n} = instrumentSlice.actions;\n\nexport default instrumentSlice.reducer;"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AAQA,MAAM,eAAgC;IACpC,KAAK;IACL,WAAW;IACX,uBAAuB;AACzB;AAEO,MAAM,kBAAkB,IAAA,6MAAW,EAAC;IACzC,MAAM;IACN;IACA,UAAU;QACR,QAAQ,CAAC,OAAO;YACd,MAAM,GAAG,GAAG,OAAO,OAAO;QAC5B;QACA,cAAc,CAAC,OAAO;YACpB,MAAM,SAAS,GAAG,OAAO,OAAO;QAClC;QACA,0BAA0B,CAAC,OAAO;YAChC,MAAM,qBAAqB,GAAG,OAAO,OAAO;QAC9C;QACA,OAAO,CAAC;YACN,MAAM,SAAS,GAAG;YAClB,MAAM,qBAAqB,GAAG;QAChC;IACF;AACF;AAEO,MAAM,EACX,MAAM,EACN,YAAY,EACZ,wBAAwB,EACxB,KAAK,EACN,GAAG,gBAAgB,OAAO;uCAEZ,gBAAgB,OAAO"}},
    {"offset": {"line": 565, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/entities/tuner/model/slice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { TunerResult } from '../../../domain/entities';\n\nexport type TunerMode = 'chromatic' | 'guitar';\n\ninterface TunerState {\n  isOpen: boolean;\n  isRunning: boolean;\n  currentNote: string;\n  currentFrequency: number;\n  currentDetune: number;\n  pointerPosition: number;\n  isInTune: boolean;\n  mode: TunerMode;\n  error: string | null;\n}\n\nconst initialState: TunerState = {\n  isOpen: false,\n  isRunning: false,\n  currentNote: \"-\",\n  currentFrequency: 0,\n  currentDetune: 0,\n  pointerPosition: 50,\n  isInTune: false,\n  mode: 'chromatic',\n  error: null,\n};\n\nexport const tunerSlice = createSlice({\n  name: 'tuner',\n  initialState,\n  reducers: {\n    openTuner: (state) => {\n      state.isOpen = true;\n      state.error = null;\n    },\n    closeTuner: (state) => {\n      state.isOpen = false;\n      state.isRunning = false;\n    },\n    setTunerMode: (state, action: PayloadAction<TunerMode>) => {\n      state.mode = action.payload;\n      // Reset UI when mode changes\n      state.currentNote = \"-\";\n      state.isInTune = false;\n      state.currentFrequency = 0;\n      state.currentDetune = 0;\n      state.pointerPosition = 50;\n    },\n    startTuner: (state) => {\n      state.isRunning = true;\n      state.error = null;\n    },\n    stopTuner: (state) => {\n      state.isRunning = false;\n      // Reset UI when stopping\n      state.currentNote = \"-\";\n      state.isInTune = false;\n      state.currentFrequency = 0;\n      state.currentDetune = 0;\n      state.pointerPosition = 50;\n    },\n    updateTunerResult: (state, action: PayloadAction<TunerResult>) => {\n      const { note, frequency, cents, isInTune } = action.payload;\n      \n      state.currentNote = note;\n      state.currentFrequency = frequency;\n      state.currentDetune = cents;\n      state.isInTune = isInTune;\n      \n      // Convert cents (-50 to +50) to percentage (0% to 100%)\n      let percent = 50 + cents;\n      \n      // Clamp values\n      if (percent < 0) percent = 0;\n      if (percent > 100) percent = 100;\n      \n      state.pointerPosition = percent;\n    },\n    setTunerError: (state, action: PayloadAction<string>) => {\n      state.error = action.payload;\n      state.isRunning = false;\n    },\n    clearTunerError: (state) => {\n      state.error = null;\n    }\n  }\n});\n\nexport const {\n  openTuner,\n  closeTuner,\n  setTunerMode,\n  startTuner,\n  stopTuner,\n  updateTunerResult,\n  setTunerError,\n  clearTunerError\n} = tunerSlice.actions;\n\nexport default tunerSlice.reducer;"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;AAiBA,MAAM,eAA2B;IAC/B,QAAQ;IACR,WAAW;IACX,aAAa;IACb,kBAAkB;IAClB,eAAe;IACf,iBAAiB;IACjB,UAAU;IACV,MAAM;IACN,OAAO;AACT;AAEO,MAAM,aAAa,IAAA,6MAAW,EAAC;IACpC,MAAM;IACN;IACA,UAAU;QACR,WAAW,CAAC;YACV,MAAM,MAAM,GAAG;YACf,MAAM,KAAK,GAAG;QAChB;QACA,YAAY,CAAC;YACX,MAAM,MAAM,GAAG;YACf,MAAM,SAAS,GAAG;QACpB;QACA,cAAc,CAAC,OAAO;YACpB,MAAM,IAAI,GAAG,OAAO,OAAO;YAC3B,6BAA6B;YAC7B,MAAM,WAAW,GAAG;YACpB,MAAM,QAAQ,GAAG;YACjB,MAAM,gBAAgB,GAAG;YACzB,MAAM,aAAa,GAAG;YACtB,MAAM,eAAe,GAAG;QAC1B;QACA,YAAY,CAAC;YACX,MAAM,SAAS,GAAG;YAClB,MAAM,KAAK,GAAG;QAChB;QACA,WAAW,CAAC;YACV,MAAM,SAAS,GAAG;YAClB,yBAAyB;YACzB,MAAM,WAAW,GAAG;YACpB,MAAM,QAAQ,GAAG;YACjB,MAAM,gBAAgB,GAAG;YACzB,MAAM,aAAa,GAAG;YACtB,MAAM,eAAe,GAAG;QAC1B;QACA,mBAAmB,CAAC,OAAO;YACzB,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,OAAO;YAE3D,MAAM,WAAW,GAAG;YACpB,MAAM,gBAAgB,GAAG;YACzB,MAAM,aAAa,GAAG;YACtB,MAAM,QAAQ,GAAG;YAEjB,wDAAwD;YACxD,IAAI,UAAU,KAAK;YAEnB,eAAe;YACf,IAAI,UAAU,GAAG,UAAU;YAC3B,IAAI,UAAU,KAAK,UAAU;YAE7B,MAAM,eAAe,GAAG;QAC1B;QACA,eAAe,CAAC,OAAO;YACrB,MAAM,KAAK,GAAG,OAAO,OAAO;YAC5B,MAAM,SAAS,GAAG;QACpB;QACA,iBAAiB,CAAC;YAChB,MAAM,KAAK,GAAG;QAChB;IACF;AACF;AAEO,MAAM,EACX,SAAS,EACT,UAAU,EACV,YAAY,EACZ,UAAU,EACV,SAAS,EACT,iBAAiB,EACjB,aAAa,EACb,eAAe,EAChB,GAAG,WAAW,OAAO;uCAEP,WAAW,OAAO"}},
    {"offset": {"line": 665, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/store/index.ts"],"sourcesContent":["import { configureStore } from '@reduxjs/toolkit';\nimport playerReducer from './slices/playerSlice';\nimport tunerReducer from './slices/tunerSlice';\nimport measureReducer from '../entities/measure/model/slice';\nimport instrumentReducer from '../entities/instrument/model/slice';\nimport newTunerReducer from '../entities/tuner/model/slice';\n\nexport const store = configureStore({\n  reducer: {\n    player: playerReducer,\n    tuner: tunerReducer,\n    // New slices\n    measure: measureReducer,\n    instrument: instrumentReducer,\n    newTuner: newTunerReducer,\n  },\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware({\n      serializableCheck: {\n        // Удалены правила для audio slice, так как он больше не используется\n      },\n    }),\n});\n\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAEO,MAAM,QAAQ,IAAA,gNAAc,EAAC;IAClC,SAAS;QACP,QAAQ,mJAAa;QACrB,OAAO,kJAAY;QACnB,aAAa;QACb,SAAS,0JAAc;QACvB,YAAY,6JAAiB;QAC7B,UAAU,wJAAe;IAC3B;IACA,YAAY,CAAC,uBACX,qBAAqB;YACnB,mBAAmB;YAEnB;QACF;AACJ"}},
    {"offset": {"line": 702, "column": 0}, "map": {"version":3,"sources":["file:///Users/dmitrij/Desktop/strummaster/src/app/providers.tsx"],"sourcesContent":["'use client';\n\nimport { Provider } from 'react-redux';\nimport { store } from '../store';\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  return (\n    <Provider store={store}>\n      {children}\n    </Provider>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKO,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACnE,qBACE,6LAAC,wKAAQ;QAAC,OAAO,iIAAK;kBACnB;;;;;;AAGP;KANgB"}}]
}